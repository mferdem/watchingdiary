<!-- templates/index.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">

  {% include 'year_month_picker.html' %}
  
  <table class="table table-bordered">
    <thead>
      <tr>
        <th style="width: 10%;">Tarih</th>
        <th>Aktiviteler</th>
      </tr>
    </thead>
    <tbody>
      {% for day in days %}
        <tr>
          <td style="white-space: nowrap; font-size: 0.9rem; text-align: right; vertical-align: middle;">
            {{ day.strftime("%d %B '%y %A") }}
          </td>
          <td>
            <div class="row gx-2 gy-2 ">
              {% for log in logs_by_date.get(day, []) %}
                {% set size = 2 %}
                {% if log.activity_type == 'maç' and log.location %}
                  {% set size = 8 %}
                {% elif log.activity_type in event_styles %}
                  {% set size = event_styles[log.activity_type]['size'] %}
                {% endif %}
            
                <div class="col-{{ size }}">
                  <div class="position-relative p-2 text-white text-center rounded event-{{ log.activity_type }}">
                    <!-- Sil ve Düzenle Butonları -->
                    <div style="position: absolute; top: 2px; right: 4px; display: flex; gap: 4px;">
                      <!-- Düzenle -->
                      <a href="{{ url_for('main.edit_log', log_id=log.id) }}"
                         class="btn btn-sm btn-light d-flex align-items-center justify-content-center"
                         title="Düzenle"
                         style="width: 20px; height: 20px; font-size: 0.75rem; padding: 0;">✏</a>
                         
                      <!-- Sil -->
                      <form method="POST" action="{{ url_for('main.delete_log', log_id=log.id) }}"
                            onsubmit="return confirm('Bu log silinsin mi?')">
                        <button class="btn btn-sm btn-danger d-flex align-items-center justify-content-center"
                                title="Sil"
                                style="width: 20px; height: 20px; font-size: 0.75rem; padding: 0;">×</button>
                      </form>
                    
                      
                    </div>

            
                    <!-- İçerik -->
                    <div class="pe-3 text-truncate">
                      {% if log.activity_type == 'film' %}
                        {{ log.name }}{% if log.year %} ({{ log.year }}){% endif %}
            
                      {% elif log.activity_type == 'dizi' %}
                        {{ log.name }}
                        {% if log.season and log.episode %}
                          {{ log.season }}{{ "%02d"|format(log.episode) }}
                        {% endif %}
            
                      {% elif log.activity_type == 'maç' %}
                        {% if 'beşiktaş' in log.name|lower %}
                          <img src="{{ url_for('static', filename='img/bjk.svg') }}" alt="Beşiktaş" style="height: 20px; margin-right: 5px; vertical-align: middle;">
                        {% elif 'türkiye' in log.name|lower %}
                          <img src="{{ url_for('static', filename='img/turkey.png') }}" alt="Türkiye" style="height: 20px; margin-right: 5px; vertical-align: middle;">
                        {% endif %}
                        {{ log.name }}{% if log.location %} @{{ log.location }}{% endif %}
            
                      {% elif log.activity_type == 'konser' %}
                        {{ log.name }}{% if log.location %} @{{ log.location }}{% endif %}
            
                      {% else %}
                        {{ log.name }}
                      {% endif %}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
            
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  
</div>
<button class="btn btn-primary position-fixed bottom-0 end-0 m-4" data-bs-toggle="modal" data-bs-target="#newLogModal" style="z-index: 1050;">
  + Yeni Log
</button>


{% include 'modals/new_log_modal.html' %}
{% endblock %}
